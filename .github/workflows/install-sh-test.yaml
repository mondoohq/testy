name: Test install.sh

on:
  workflow_dispatch:
        inputs: 
            version:
                description: 'Version'
                required: true
                default: '8.0.0'


jobs:
    install-sh-linux:
        runs-on: ubuntu-latest
        strategy:
            matrix:
              distro: ['debian:10', 'debian:11', 'ubuntu:18.04', 'ubuntu:20.04', 'centos:7', 'centos:8', 'fedora:32', 'fedora:33', 'opensuse/leap:15.2', 'opensuse/leap:15.3', 'opensuse/tumbleweed:latest', 'alpine:3.12', 'alpine:3.13', 'alpine:3.14']
        steps:
            - uses: actions/checkout@v2
            - name: Install.sh on ${{ matrix.distro }}
              run: |
                  docker run --rm -v $(pwd):/work -w /work ${{ matrix.distro }} \
                  bash -c "apt-get update && apt-get install -y curl && curl -sL curl -sSL https://install.mondoo.com/sh/cnquery | bash - && cnquery version"

            
